\section{Software}
\label{software}

Cada vez mais fazer pesquisa de ponta envolve desenvolver algum tipo de
software.
Isso é verdade para diversos ramos da ciência, da biologia à geofísica e até
mesmo nas ciências sociais.
Aplicações variam de baixar da internet para seu computador dados de fontes
governamentais
a realizar tomografia sísmica de ponta em um \textit{cluster}.
Na ciência moderna, muitas vezes o software assume o papel da metodologia
experimental.
Logo é de se esperar que os programas e seus códigos fonte sejam submetidos
ao mesmo rigor que impomos no resto da ciência experimental.
Infelizmente essa não é a realidade ainda.
Nos próximos 10 anos, questões envolvendo a avaliação da qualidade e
confiabilidade de resultados computacionais serão centrais no cenário
científico internacional.
No entanto, o sistema de educação superior atual fornece pouco treinamento nas
habilidades necessárias para lidar com essa nova realidade.
Algumas iniciativas, como o \textit{Software Carpentry}
(\url{https://software-carpentry.org/}), estão atacando diretamente esses
problemas oferecendo treinamento computacional direcionado a cientistas.

Minha pesquisa sempre teve um viés computacional.
Ao longo dos últimos dez anos, dei início a três projetos de software livre.
A seguir, discorro sobre minha formação em desenvolvimento de software e sobre
a concepção e os impactos de cada projeto.


\subsection{Formação}

Meu primeiro contato com a programação foi através da disciplina
``Introdução à Computação para Ciências Exatas e Tecnologia''
que cursei em 2004 durante meu primeiro semestre na USP.
Antes disso, eu não tinha conhecimento algum de como programas de computador
são feitos ou que qualquer um poderia criar o seu próprio programa.
Aprendi os conceitos básicos da linguagem de programação C.
Porém, não acalcei um nível suficientemente avançado para enxergar aplicações
imediatas da programação nas demais disciplinas do curso de geofísica.

Busquei aprender mais sobre a linguagem C através da disciplina optativa
``Computação para Geofísicos''.
Nela desenvolvi aplicações diretas à geofísica como o cálculo do International
Geomagnetic Reference Field (IGRF) a partir dos coeficientes de harmônicos
esféricos e o método de \citet{talwani1959} para modelagem direta na
gravimetria.
O código que criei para a disciplina foi utilizado anos depois como base
para a implementação do método de \citet{talwani1959} no programa
\textit{Fatiando a
Terra}\footnote{\url{www.fatiando.org/v0.5/api/gravmag.talwani.html}}.
Essas aplicações me mostraram o enorme poder da programação no aprendizado de
conceitos complexos da geofísica e da matemática.
Ao criar uma implementação computacional de um método, o aluno é levado a
considerar detalhes e fazer perguntas que pode não ter notado ao estudar a
teoria.
Além disso, também é capaz de explorar as possibilidades e os limites de uma
teoria de forma dinâmica e independente.
Não exagero quando afirmo que ter cursado a disciplina ``Computação para
Geofísicos'' foi crucial para o resto de minha carreira.

Nos anos seguintes comecei a estudar a programação nas horas vagas e a aplicar
à geofísica o que estava aprendendo.
Implementei a Transformada Discreta de Fourier\footnote{Disponível em
\url{https://github.com/leouieda/dft-in-c}} para estudar para a disciplina
``Processamento de Sinais Digitais''.
Utilizei minha implementação do método de otimização Ant Colony Optimization
\citep{socha2008} para realizar uma inversão das velocidades de grupo de ondas
Love\footnote{Disponível em \url{https://github.com/leouieda/love-aco-inv}}
para a disciplina ``Teoria de Ondas Sísmicas e Estrutura da Terra''.
Para as disciplinas de geodésia que cursei durante meu intercâmbio na York
University, implementei ajustes de redes gravimétricas, mudança de sistemas de
coordenadas geográficas, entre outros.
Aprendi as linguagens de programação C++, Java e Python.
Cursei a disciplina optativa ``Princípios de Desenvolvimento de Algoritmos''
onde aprendi os conceitos que possibilitaram alguns dos avanços que obtive em
\citet{tesseroids}.

Em 2008 descobri a organização sem fins lucrativos \textit{Software Carpentry}.
Segundo \url{https://software-carpentry.org} (acessado em 7 de julho de 2017),
seu objetivo é ``Ensinar habilidades laboratoriais básicas para pesquisa
computacional''.
Através de seu material, disponível gratuitamente na internet, descobri o
quanto eu não sabia sobre o desenvolvimento sustentável de software para
pesquisa científica.
Aprendi sobre ferramentas fundamentais da computação que até então eu
desconhecia, como sistemas de controle de versão, testes unitários e
rastreamento da procedência de resultados.
Atualmente utilizo essas ferramentas no meu dia-a-dia como pesquisador e
professor, seja para escrever
artigos\footnote{\url{https://github.com/pinga-lab/paper-moho-inversion-tesseroids}}
ou manejar a entrega de trabalhos práticos em minha disciplina de computação e
cálculo numérico\footnote{\url{https://github.com/mat-esp-2016}}.

Durante a pós-graduação continuei com a abordagem de criar uma implementação
computacional do que aprendia nas disciplinas.
No entanto, optei por agrupar todo código fonte que desenvolvi em uma única
biblioteca feita na linguagem Python: o projeto \textit{Fatiando a Terra}.
Para a disciplina de ondas sísmicas, por exemplo, implementei uma solução por
diferenças finitas da equação da
onda\footnote{\url{www.fatiando.org/v0.5/api/seismic.wavefd.html}} para
investigar se ondas Love realmente resultam de ondas S
horizontais\footnote{\url{https://youtu.be/YjhSvEpbzps}} e se ondas Rayleigh
possuem movimento elíptico
retrógrado\footnote{\url{https://youtu.be/Mvd8FANLqy4}}.
Concomitantemente, continuei aprimorando minhas habilidades com o
desenvolvimento de software através da experiência pessoal com o
\textit{Fatiando a Terra}.



\subsection{Tesseroids}

Em 2007 iniciei um estágio de iniciação científica com a Profa. Dra. Naomi
Ussami.
Meu projeto era parte de uma colaboração com a Profa. Dra. Carla Braitenberg da
University of Trieste, Itália.
O objetivo dessa colaboração era preparar a comunidade científica para lidar
com os dados de gradiometria gravimétrica que seriam coletados pelo satélite
GOCE (Gravity field and steady-state Ocean Circulation Explorer).
Minha participação nesse projeto seria desenvolver um programa para a modelagem
direta dos dados utilizando tesseroides (prismas esféricos).
Ficou determinado que o método que eu utilizaria para isso é a Quadratura
Gauss-Legendre, como proposto por \citet{asgharzadeh2007} e
\citet{wild-pfeiffer2008}.
Decidi realizar minha implementação dessa metodologia na linguagem Python, que
estava aprendendo na época.
No final de 2009 defendi meu trabalho de conclusão de curso e lancei da versão
0.3 do software batizado de \textit{Tesseroids}\footnote{Código fonte da versão
0.3 disponível em \url{https://doi.org/10.5281/zenodo.15804}}.

O programa começou a ser utilizado pelo grupo de pesquisa da Profa.
Braitenberg.
Durante os testes iniciais, descobriram que o tempo de execução do programa era
muito elevado para calcular os efeitos de modelos digitais de terreno
realistas.
Atribuo essa deficiência à minha inexperiência com a linguagem Python, não a
uma limitação da mesma.
A convite da Profa. Braitenberg, fui passar um mês em Trieste, Itália,
para reimplementar o software em linguagem C e torná-lo mais rápido e preciso.
Durante o mês de fevereiro, reescrevi todo o software em C e adicionei
sistemas automáticos de testes unitários e geração de documentação online.
Também implementei um método para a discretização adaptativa dos modelos,
melhorando a estabilidade dos cálculos.
No final de abril, lancei a versão 1.0 do \textit{Tesseroids}.
Essa versão passou a ser utilizada pelo grupo de Trieste e também por outros
grupos de pesquisa da Europa e América do Sul.
Por exemplo, os seguintes trabalhos mencionam uso dessa versão do software:
\citet{alvarez2012}, \citet{mariani2013} e \citet{bouman2013}.

Continuei o desenvolvimento da metodologia de discretização adaptativa e do
software durante meu doutorado.
Finalmente, lancei a versão 1.2 em 2015 com alguns avanços metodológicos.
Esta versão acompanha a publicação \citet{tesseroids} na seção \textit{Software
and Alrogithms} da revista \textit{Geophysics}.
Até o momento, meus trabalhos relacionados ao software \textit{Tesseroids}
receberam juntos cerca de 50 citações\footnote{Segundo a base Google Scholar:
\url{https://scholar.google.com.br/citations?user=qfmPrUEAAAAJ&hl=en}}.

Ao olhar todo o histórico do desenvolvimento desse
projeto\footnote{Disponível em
\url{https://github.com/leouieda/tesseroids/commits}},
percebo o quanto aprendi em cada etapa.
Sinto orgulho e felicidade ao perceber que algo que eu criei foi útil para
tantas outras pessoas.
Esse sentimento é o que me motivou a continuar desenvolvendo essas ferramentas
e as disponibilizando de maneira livre e gratuita.



\subsection{Fatiando a Terra}


O \textit{Fatiando a Terra} é uma biblioteca (coleção de funções e classes)
feita na linguagem Python.
Sua funcionalidade abrange diversas áreas da geofísica, com foco em métodos
potenciais.
Comecei seu desenvolvimento durante meu mestrado no Observatório Nacional,
inicialmente incluindo funções na biblioteca que implementava durante as
disciplinas como uma forma de estudo.
Eventualmente, esse código se tornou a base para minha implementação do método
de inversão que desenvolvi como projeto de mestrado \citep[][cujo código está
disponível em
\url{https://github.com/pinga-lab/paper-planting-densities}]{seed}.
Em 2012, fui convidado para ministrar um minicurso de inversão na escola de
verão do IAG/USP junto com meu
amigo Vanderlei C. Oliveira Jr. (na época também aluno da Profa.  Valéria).
Desenvolvemos diversos exercícios práticos para o curso utilizando o
\textit{Fatiando a Terra}.
Como consequência disso, a biblioteca cresceu com a adição de diversas funções
novas.
Também criei a primeira versão da página de documentação
\url{http://www.fatiando.org} lançamos a versão 0.0.1 do programa.
Os exercícios e apresentações criados para esse curso estão disponíveis em
\url{https://github.com/pinga-lab/inversao-iag-2012}.

Trabalhei no desenvolvimento do \textit{Fatiando} continuamente durante todo
meu doutorado.
Em 2013, apresentei sobre o projeto no congresso Scientific Computing with
Python (Scipy) em Austin, E.U.A., resultando na publicação de \citet{fatiando}
nos anais do congresso e no lançamento da versão 0.1.
O código fonte utilizado nessa publicação está disponível na página
\url{http://www.leouieda.com/talks/scipy2013.html} e há uma gravação da
palestra no YouTube (\url{https://www.youtube.com/watch?v=Ec38h1oB8cc}).
Até esse momento, quase todo o desenvolvimento era feito por mim com algumas
colaborações esporádicas de amigos da minha turma de graduação.

Apresentei novamente sobre o \textit{Fatiando} na edição de 2014 do congresso
Scipy (\url{http://www.leouieda.com/posters/scipy2014.html}), dessa vez sobre
os algoritmos de inversão recentemente implementados na biblioteca.
Após esse evento, concentrei meus esforços em melhorar a documentação e
disponibilidade do \textit{Fatiando} com o objetivo de atrair
contribuidores para o projeto.
Percebi que para o projeto crescer, seria necessário envolver outros
programadores.
Com minha entrada na UERJ, essa necessidade se tornou mais evidente.
A carga horária de aulas combinada com o trabalho na tese de doutorado deixava
pouquíssimo tempo para a programação.
Mesmo assim, o \textit{Fatiando} foi tema de uma entrevista no Boletim da
Sociedade Brasileira de Geofísica número
89\footnote{\url{https://www.sbgf.org.br/home/images/stories/Arquivos/Boletim_89-2014.pdf}}.

Meus esforços para documentar o processo de submeter uma contribuição e para
facilitar a instalação do programa começaram a dar fruto em 2015.
O projeto recebeu contribuições de duas pessoas com as quais eu não tinha
contato prévio\footnote{\url{http://www.fatiando.org/v0.4/contributors.html}}.
Também surgiram os primeiros trabalhos publicados de fora do meu grupo de
pesquisa que mencionam a utilização do \textit{Fatiando}:
\citet{niccoli2015}, \citet{matthews2016} e \citet{bassett2016}.
Dentre esses, destaco \citet{matthews2016} que utilizou a modelagem direta de
dados de gradiometria gravimétrica com prismas retangulares retos.
Os autores compararam implementação do \textit{Fatiando} com a do software
comercial \textit{ModelVision} da empresa pbEncom, concluindo que a versão do
\textit{Fatiando} proporcionou resultado com maior acurácia para algumas
componentes.
Atualmente, a próxima versão do \textit{Fatiando} (0.6) contará com
contribuições de 13 pessoas, 5 das quais eu não conheço
pessoalmente\footnote{\url{http://www.fatiando.org/dev/contributors.html}}.

A maioria dos artigos e teses recentes do Grupo de Pesquisa em Problemas
Inversos em Geofísica (PINGA), liderado por mim e os Professores do
Observatório Nacional
Vanderlei C. Oliveira Jr e Valéria C. F. Barbosa,
utiliza o \textit{Fatiando a Terra} de alguma forma.
Diversos desses trabalhos disponibilizam seu código fonte livremente através de
repositórios na página do grupo \url{https://github.com/pinga-lab}.
Por exemplo,
\citet{magdir}\footnote{\url{https://github.com/pinga-lab/Total-magnetization-of-spherical-bodies}},
\citet{reis2016}\footnote{\url{https://github.com/pinga-lab/magnetization-rock-sample}},
\citet{moho}\footnote{\url{https://github.com/pinga-lab/paper-moho-inversion-tesseroids}}
e
\citet{monogenic2017}\footnote{\url{https://github.com/pinga-lab/paper-monogenic-signal}}.

Ao longo dos 7 anos que passei desenvolvendo o \textit{Fatiando},
aprimorei minhas habilidades de programação em Python e aprendi diversas lições
sobre a administração de um projeto de software livre.
Os maiores desafios não estão relacionados à programação diretamente, mas sim à
criação de uma comunidade ativa e empolgada em torno do projeto.


\subsection{GMT/Python}

Após terminar meu doutorado em abril de 2016, comecei a procurar oportunidades
para fazer um pós-doutorado no exterior.
Havia passado os últimos dois anos me familiarizando com a vida de professor
universitário, ministrando de duas a quatro disciplinas por semestre e
trabalhando na minha tese de doutorado durante os recessos.
Estava exausto e ponderando o futuro ruma de minha carreira em pesquisa.
Logo, percebi que estava na hora de procurar outra experiência internacional.
Alguns meses depois, recebi um comunicado através de uma lista de emails que o
Prof. Paul Wessel da University of Hawaii, E.U.A., estava procurando candidatos
com experiência em programação em Python para um pós-doutorado.
A responsabilidade do candidato selecionado seria construir uma interface
para acessar os comandos do Generic Mapping Tools (GMT,
\url{http://gmt.soest.hawaii.edu}) através da linguagem Python.
Além disso, também utilizaria essa interface para realizar pesquisas na área de
tectônica de placas e métodos potenciais.
Depois de conversar a respeito com minha esposa, resolvi aplicar para a
posição e fui selecionado\footnote{Escrevi a respeito de minhas escolhas e o
processo de seleção em
\url{http://www.leouieda.com/blog/hawaii-gmt-postdoc.html}}.
Confesso que a perspectiva de morar por dois anos no Havaí contribuiu
de forma não insignificante para minha decisão.
Em fevereiro de 2017 me mudei para Honolulu para iniciar o pós-doutorado.

O projeto \textit{GMT/Python} é uma biblioteca escrita em Python que se
comunica com o GMT através de um mecanismo chamado \textit{foreign function
interface} (FFI).
Esse mecanismo possibilita que funções escritas em uma linguagem de programação
sejam utilizadas em programas feitos em outra linguagem.
Por exemplo, programas feitos em Python podem utilizar a FFI para executar
funções de uma biblioteca escrita em C, a linguagem na qual é feito o GMT.
Um vantagem do Python é que seu interpretador oficial é implementado em C,
facilitando a interação entre as duas linguagens.
A maior dificuldade que encontrei até o presente momento é a enorme
complexidade do GMT.
Existem dezenas de módulos, cada um com diversas opções e particularidades,
implementados em milhares de linhas de código.

O primeiro passo desse projeto foi auxiliar o Prof. Wessel no desenvolvimento
de um modo de excussão moderno (chamado \textit{modern mode}) para o
GMT\footnote{Documentação na página do GMT
\url{http://gmt.soest.hawaii.edu/projects/gmt/wiki/Modernization}}.
Esse modo simplifica a utilização do GMT e introduz comandos novos para
facilitar a criação de figuras complexas com múltiplos gráficos.
A interação com o Prof. Wessel se mostrou indispensável para a elaboração do
\textit{GMT/Python}.
Essa está sendo uma oportunidade única de aprender com alguém que possui
décadas de experiência com software livre.
Outro benefício é a proximidade com a fronteira da pesquisa em tectônica de
placas, que é a especialidade do Prof. Wessel.

Atualmente, o \textit{GMT/Python} está em processo de desenvolvimento.
Já desenvolvi a base necessária para acessar a biblioteca do GMT
e estou no processo de adaptar cada um dos mais de 90 módulos.
Apresentarei sobre os resultados que obtivemos até o momento no congresso
Scientific Computing with Python (Scipy)\footnote{Escrevi sobre o trabalho que
submetemos e as revisões que recebemos em
\url{http://www.leouieda.com/blog/scipy2017-proposal-gmt.html}} em julho de 2017 em Austin, E.U.A.
Optamos por manter o código fonte e nossos planos para o projeto aberto ao
público.
Todo o desenvolvimento e planejamento acontece através da página
\url{https://github.com/GenericMappingTools/gmt-python}.

Este projeto é extremamente promissor devido à enorme base de usuários do GMT
e a crescente popularidade do Python na ciência.
Além disso, atualmente existem poucas alternativas para geração de mapas de
qualidade em Python.
Por exemplo, usuários do software GPlates \citep{gplates} poderão se beneficiar
do \textit{GMT/Python} pois o mesmo possui uma interface com a linguagem Python
e faz amplo uso do GMT.
